(function webpackUniversalModuleDefinition(root, factory) {
	if(typeof exports === 'object' && typeof module === 'object')
		module.exports = factory(require("jquery"));
	else if(typeof define === 'function' && define.amd)
		define(["jquery"], factory);
	else if(typeof exports === 'object')
		exports["DSValidation"] = factory(require(undefined));
	else
		root["DSValidation"] = factory(root["jQuery"]);
})(this, function(__WEBPACK_EXTERNAL_MODULE_1__) {
return /******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId])
/******/ 			return installedModules[moduleId].exports;
/******/
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			exports: {},
/******/ 			id: moduleId,
/******/ 			loaded: false
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.loaded = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(0);
/******/ })
/************************************************************************/
/******/ ([
/* 0 */
/***/ function(module, exports, __webpack_require__) {

	"use strict";
	
	var _interopRequire = function (obj) { return obj && obj.__esModule ? obj["default"] : obj; };
	
	/**
	 * Client-side form validation logic. Form element is validated based
	 * on `data-validate` attribute, and validation output is placed in
	 * corresponding `<label>`.
	 *
	 * Validations can be added later by extending `NEUE.Validation.Validations`.
	 * Validators can be added later by extending `NEUE.Validation.Validators`.
	 *
	 * finished validating with a boolean `success` and a plain-text `message`
	 * value. (Alternatively, a `suggestion` value can be passed which will
	 * prompt the user "Did you mean {suggestion}?".
	 *
	 * ## Usage Notes:
	 * - Input field must have `data-validate` attribute.
	 * - If adding input fields to the DOM after load, run `prepareFields`
	 */
	
	var $ = _interopRequire(__webpack_require__(1));
	
	var Events = _interopRequire(__webpack_require__(2));
	
	var validations = [];
	
	/**
	 * Returns whether element is <input>, <select>, or <textarea>.
	 * @param {jQuery} $el  Element to check type of.
	 * @return {boolean}
	 */
	var isFormField = function isFormField($el) {
	  var tag = $el.prop("tagName");
	  return tag === "INPUT" || tag === "SELECT" || tag === "TEXTAREA";
	};
	
	/**
	 * Show validation message in markup.
	 *
	 * @param {jQuery} $field              Field to display validation message for.
	 * @param {Object} result              Object containing `success` and either `message` or `suggestion`
	 */
	var showValidationMessage = function showValidationMessage($field, result) {
	  var $fieldLabel = $("label[for='" + $field.attr("id") + "']");
	  var $fieldValidation = $fieldLabel.find(".validation");
	  var $fieldMessage = $fieldValidation.find(".validation__message");
	  var fieldLabelHeight = $fieldLabel.height();
	  var fieldMessageHeight;
	
	  $field.removeClass("has-success has-error has-warning shake");
	  $fieldMessage.removeClass("has-success has-error has-warning");
	
	  // Highlight/animate field
	  if (result.success === true) {
	    $field.addClass("has-success");
	    $fieldMessage.addClass("has-success");
	  } else {
	    $field.addClass("has-error");
	    $fieldMessage.addClass("has-error");
	
	    if (isFormField($field)) {
	      $field.addClass("shake");
	    }
	
	    Events.publish("Validation:InlineError", $fieldLabel.attr("for"));
	  }
	
	  // Show validation message
	  if (result.message) {
	    $fieldMessage.text(result.message);
	  }
	
	  if (result.suggestion) {
	    $fieldMessage.html("Did you mean " + result.suggestion.full + "? <a href='#' data-suggestion='" + result.suggestion.full + "'class='js-mailcheck-fix'>Fix it!</a>");
	    Events.publish("Validation:Suggestion", result.suggestion.domain);
	  }
	
	  fieldMessageHeight = $fieldMessage.height();
	
	  // Set label height if it needs to be multiline.
	  if (fieldMessageHeight > fieldLabelHeight) {
	    $fieldLabel.css("height", fieldMessageHeight + "px");
	  } else {
	    // Clear previous multiline height if no longer needed.
	    $fieldLabel.css("height", "");
	  }
	
	  // Animate in the validation message
	  $fieldValidation.addClass("is-showing-message");
	
	  $(".js-mailcheck-fix").on("click", function (e) {
	    e.preventDefault();
	
	    var $field = $("#" + $(this).closest("label").attr("for"));
	    $field.val($(this).data("suggestion"));
	    $field.trigger("blur");
	
	    // If Google Analytics is set up, we fire an event to
	    // mark that a suggestion has been made
	    Events.publish("Validation:SuggestionUsed", $(this).text());
	  });
	
	  $field.on("focus", function () {
	    $field.removeClass("has-warning has-error has-success shake");
	    $fieldValidation.removeClass("is-showing-message");
	    $fieldLabel.css("height", "");
	  });
	
	  return result.success;
	};
	
	/**
	 * Trigger a validation on a form element.
	 * @param {jQuery}   $field                            Form element to be validated.
	 * @param {jQuery}   [force = false]                   Force validation (even on empty fields).
	 * @param {function} [callback=showValidationMessage]  Callback function that receives validation result
	 */
	var validateField = (function (_validateField) {
	  var _validateFieldWrapper = function validateField(_x, _x2, _x3) {
	    return _validateField.apply(this, arguments);
	  };
	
	  _validateFieldWrapper.toString = function () {
	    return _validateField.toString();
	  };
	
	  return _validateFieldWrapper;
	})(function ($field, force, callback) {
	  // Default arguments
	  force = typeof force !== "undefined" ? force : false;
	  callback = typeof callback !== "undefined" ? callback : function ($field, result) {
	    showValidationMessage($field, result);
	  };
	
	  var validation = $field.data("validate");
	
	  // Trigger any other linked validation
	  var validationTrigger = $field.data("validate-trigger");
	  if (validationTrigger) {
	    validateField($(validationTrigger));
	  }
	
	  // Don't validate if validation doesn't exist
	  if (!validations[validation]) {
	    console.error("A validation with the name " + validation + " has not been registered.");
	    return;
	  }
	
	  // For <input>, <select>, and <textarea> tags we provide
	  // the field's value as a string
	  if (isFormField($field)) {
	    // Get field info
	    var fieldValue = $field.val();
	
	    // Finally, let's not validate blank fields unless forced to
	    if (force || fieldValue !== "") {
	      if (validation === "match") {
	        var matchFieldValue = $($field.data("validate-match")).val();
	        validations[validation].fn(fieldValue, matchFieldValue, function (result) {
	          callback($field, result);
	        });
	      } else {
	        validations[validation].fn(fieldValue, function (result) {
	          callback($field, result);
	        });
	      }
	    }
	  } else {
	    // For all other tags, we pass the element directly
	    if (validation === "match") {
	      var $matchField = $($field.data("validate-match"));
	      validations[validation].fn($field, $matchField, function (result) {
	        callback($field, result);
	      });
	    } else {
	      validations[validation].fn($field, function (result) {
	        callback($field, result);
	      });
	    }
	  }
	});
	
	/**
	 * Prepare field label DOM to display validation messages.
	 * @param {jQuery} $label Label element to prepare.
	 */
	var prepareLabel = function prepareLabel($label) {
	  // Check to make sure we haven't already prepared this before
	  if ($label.find(".validation").length === 0) {
	    var $innerLabel = $("<div class='validation'></div>");
	    $innerLabel.append("<div class='validation__label'>" + $label.html() + "</div>");
	    $innerLabel.append("<div class='validation__message'></div>");
	
	    $label.html($innerLabel);
	  }
	};
	
	/**
	 * Prepares form label DOM to display validation messages & register event handler
	 * @param {jQuery} $fields Fields to register validation handlers to.
	 */
	var prepareFields = function prepareFields($fields) {
	  $fields.each(function () {
	    var $field = $(this);
	
	    prepareLabel($("label[for='" + $field.attr("id") + "']"));
	
	    $field.on("blur", function (event) {
	      event.preventDefault();
	      validateField($field);
	    });
	  });
	};
	
	/**
	 * Register a new validation.
	 *
	 * @param {String}    name              The name function will be referenced by in `data-validate` attribute.
	 * @param {Object}    validation        Collection of validation rules to apply
	 * @param {Function}  [validation.fn]   Custom validation
	 */
	var registerValidation = function registerValidation(name, validation) {
	  if (validations[name]) {
	    throw "A validation function with that name has already been registered";
	  }
	
	  validations[name] = validation;
	};
	
	/**
	 * @DEPRECATED: Will be removed in a future version in favor of `registerValidation`.
	 */
	var registerValidationFunction = function registerValidationFunction(name, func) {
	  var v = {
	    fn: func
	  };
	
	  registerValidation(name, v);
	};
	
	/**
	 * Disable form submission.
	 * @param {jQuery} $form Form to disable submission for.
	 */
	var disableFormSubmit = function disableFormSubmit($form) {
	  // Prevent double-submissions
	  var $submitButton = $form.find(":submit");
	
	  // Disable that guy
	  $submitButton.attr("disabled", true);
	  $submitButton.addClass("is-loading");
	};
	
	/**
	 * Re-enable form submission.
	 * @param {jQuery} $form Form to enable submission for.
	 */
	var enableFormSubmit = function enableFormSubmit($form) {
	  var $submitButton = $form.find(":submit");
	  $submitButton.attr("disabled", false);
	  $submitButton.removeClass("is-loading is-disabled");
	};
	
	/**
	 * Validate form on submit.
	 */
	$("body").on("submit", "form", function (event, isValidated) {
	  var $form = $(this);
	  var $validationFields = $form.find("[data-validate]");
	
	  // Disable form submission to prevent double-clicks.
	  disableFormSubmit($form);
	
	  // We want to validate all [data-validate] field that are either required, or have user input.
	  $validationFields = $validationFields.map(function () {
	    var $this = $(this);
	    if (typeof $this.attr("data-validate-required") !== "undefined" || $this.val() !== "") {
	      return $this;
	    }
	  });
	
	  // If no fields should be validated, submit!
	  if ($validationFields.length === 0) {
	    return true;
	  }
	
	  if (isValidated === true) {
	    // completed a previous runthrough & validated;
	    // we're ready to submit the form
	    return true;
	  } else {
	    event.preventDefault();
	
	    var validatedFields = 0;
	    var validatedResults = 0;
	    var scrolledToError = false;
	
	    $validationFields.each(function () {
	      validateField($(this), true, function ($field, result) {
	        validatedFields++;
	        showValidationMessage($field, result);
	
	        if (result.success) {
	          validatedResults++;
	        }
	
	        // If this is the first error in the form, scroll to it.
	        if (!scrolledToError && result.success === false) {
	          scrolledToError = true;
	          $("html,body").animate({ scrollTop: $field.offset().top - 32 }, 200);
	        }
	
	        // Once we're done validating all fields, check status of form
	        if (validatedFields === $validationFields.length) {
	          if (validatedResults === $validationFields.length) {
	            // we've validated all that can be validated
	            Events.publish("Validation:Submitted", $(this).attr("id"));
	            $form.trigger("submit", true);
	          } else {
	            Events.publish("Validation:SubmitError", $(this).attr("id"));
	            enableFormSubmit($form);
	          }
	        }
	      });
	    });
	
	    return false; // don't submit form, wait for callback with `true` parameter
	  }
	});
	
	// Register the "match" validation.
	registerValidationFunction("match", function (string, secondString, done) {
	  if (string === secondString && string !== "") {
	    return done({
	      success: true,
	      message: "Looks good!"
	    });
	  } else {
	    return done({
	      success: false,
	      message: "That doesn't match."
	    });
	  }
	});
	
	$(function () {
	  // Prepare the labels on any `[data-validate]` fields in the DOM at load
	  prepareFields($("body").find("[data-validate]"));
	});
	
	// Export public API:
	module.exports = {
	  prepareFields: prepareFields,
	  registerValidation: registerValidation,
	  registerValidationFunction: registerValidationFunction,
	  validateField: validateField,
	  showValidationMessage: showValidationMessage,
	  Validations: validations,
	  Events: Events
	};

/***/ },
/* 1 */
/***/ function(module, exports, __webpack_require__) {

	module.exports = __WEBPACK_EXTERNAL_MODULE_1__;

/***/ },
/* 2 */
/***/ function(module, exports, __webpack_require__) {

	/**
	 * Pub/Sub events: Allows modules to communicate via publishing
	 * and subscribing to events.
	 *
	 * Based on Addy Osmani's Pubsubz, licensed under the GPL.
	 * https://github.com/addyosmani/pubsubz
	 * http://jsfiddle.net/LxPrq/
	 */
	
	"use strict";
	
	var topics = {};
	var subUid = -1;
	
	var publish = function publish(topic, args) {
	  if (!topics[topic]) {
	    return false;
	  }
	
	  setTimeout(function () {
	    var subscribers = topics[topic],
	        len = subscribers ? subscribers.length : 0;
	
	    while (len--) {
	      subscribers[len].func(topic, args);
	    }
	  }, 0);
	
	  return true;
	};
	
	var subscribe = function subscribe(topic, func) {
	  if (!topics[topic]) {
	    topics[topic] = [];
	  }
	
	  var token = (++subUid).toString();
	  topics[topic].push({
	    token: token,
	    func: func
	  });
	
	  return token;
	};
	
	var unsubscribe = function unsubscribe(token) {
	  for (var m in topics) {
	    if (topics[m]) {
	      for (var i = 0, j = topics[m].length; i < j; i++) {
	        if (topics[m][i].token === token) {
	          topics[m].splice(i, 1);
	          return token;
	        }
	      }
	    }
	  }
	
	  return false;
	};
	
	// Export public API
	module.exports = {
	  publish: publish,
	  subscribe: subscribe,
	  unsubscribe: unsubscribe
	};

/***/ }
/******/ ])
});
;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vd2VicGFjay91bml2ZXJzYWxNb2R1bGVEZWZpbml0aW9uIiwid2VicGFjazovLy93ZWJwYWNrL2Jvb3RzdHJhcCA2YTk4ZjMxOThkNjRjODE4M2E5ZSIsIndlYnBhY2s6Ly8vLi9zcmMvdmFsaWRhdGlvbi5qcyIsIndlYnBhY2s6Ly8vZXh0ZXJuYWwge1wicm9vdFwiOlwialF1ZXJ5XCIsXCJjb21tb25qczJcIjpcImpxdWVyeVwiLFwiYW1kXCI6XCJqcXVlcnlcIn0iLCJ3ZWJwYWNrOi8vLy4vc3JjL2V2ZW50cy5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxDQUFDO0FBQ0QsTztBQ1ZBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7O0FBRUE7QUFDQTtBQUNBLHVCQUFlO0FBQ2Y7QUFDQTtBQUNBOztBQUVBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBO0FBQ0E7OztBQUdBO0FBQ0E7O0FBRUE7QUFDQTs7QUFFQTtBQUNBOztBQUVBO0FBQ0Esd0M7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7S0NyQk8sQ0FBQyx1Q0FBTSxDQUFROztLQUNmLE1BQU0sdUNBQU0sQ0FBVTs7QUFDN0IsS0FBSSxXQUFXLEdBQUcsRUFBRSxDQUFDOzs7Ozs7O0FBUXJCLEtBQUksV0FBVyxHQUFHLHFCQUFTLEdBQUcsRUFBRTtBQUM5QixPQUFJLEdBQUcsR0FBRyxHQUFHLENBQUMsSUFBSSxDQUFDLFNBQVMsQ0FBQyxDQUFDO0FBQzlCLFVBQVMsR0FBRyxLQUFLLE9BQU8sSUFBSSxHQUFHLEtBQUssUUFBUSxJQUFJLEdBQUcsS0FBSyxVQUFVLENBQUc7RUFDdEUsQ0FBQzs7Ozs7Ozs7QUFTRixLQUFJLHFCQUFxQixHQUFHLCtCQUFTLE1BQU0sRUFBRSxNQUFNLEVBQUU7QUFDbkQsT0FBSSxXQUFXLEdBQUcsQ0FBQyxDQUFDLGFBQWEsR0FBRyxN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QUFDLEdBQUcsTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLE1BQU0sRUFBRSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsRUFBRSxFQUFFO0FBQ2hELGFBQUksTUFBTSxDQUFDLENBQUMsQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDLEtBQUssS0FBSyxLQUFLLEVBQUU7QUFDaEMsaUJBQU0sQ0FBQyxDQUFDLENBQUMsQ0FBQyxNQUFNLENBQUMsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQ3ZCLGtCQUFPLEtBQUssQ0FBQztVQUNkO1FBQ0Y7TUFDRjtJQUNGOztBQUVELFVBQU8sS0FBSyxDQUFDO0VBQ2QsQ0FBQzs7O2tCQUdhO0FBQ2IsVUFBTyxFQUFFLE9BQU87QUFDaEIsWUFBUyxFQUFFLFNBQVM7QUFDcEIsY0FBVyxFQUFFLFdBQVc7RUFDekIsQyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiB3ZWJwYWNrVW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvbihyb290LCBmYWN0b3J5KSB7XG5cdGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0JyAmJiB0eXBlb2YgbW9kdWxlID09PSAnb2JqZWN0Jylcblx0XHRtb2R1bGUuZXhwb3J0cyA9IGZhY3RvcnkocmVxdWlyZShcImpxdWVyeVwiKSk7XG5cdGVsc2UgaWYodHlwZW9mIGRlZmluZSA9PT0gJ2Z1bmN0aW9uJyAmJiBkZWZpbmUuYW1kKVxuXHRcdGRlZmluZShbXCJqcXVlcnlcIl0sIGZhY3RvcnkpO1xuXHRlbHNlIGlmKHR5cGVvZiBleHBvcnRzID09PSAnb2JqZWN0Jylcblx0XHRleHBvcnRzW1wiRFNWYWxpZGF0aW9uXCJdID0gZmFjdG9yeShyZXF1aXJlKHVuZGVmaW5lZCkpO1xuXHRlbHNlXG5cdFx0cm9vdFtcIkRTVmFsaWRhdGlvblwiXSA9IGZhY3Rvcnkocm9vdFtcImpRdWVyeVwiXSk7XG59KSh0aGlzLCBmdW5jdGlvbihfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXykge1xucmV0dXJuIFxuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svdW5pdmVyc2FsTW9kdWxlRGVmaW5pdGlvblxuICoqLyIsIiBcdC8vIFRoZSBtb2R1bGUgY2FjaGVcbiBcdHZhciBpbnN0YWxsZWRNb2R1bGVzID0ge307XG5cbiBcdC8vIFRoZSByZXF1aXJlIGZ1bmN0aW9uXG4gXHRmdW5jdGlvbiBfX3dlYnBhY2tfcmVxdWlyZV9fKG1vZHVsZUlkKSB7XG5cbiBcdFx0Ly8gQ2hlY2sgaWYgbW9kdWxlIGlzIGluIGNhY2hlXG4gXHRcdGlmKGluc3RhbGxlZE1vZHVsZXNbbW9kdWxlSWRdKVxuIFx0XHRcdHJldHVybiBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXS5leHBvcnRzO1xuXG4gXHRcdC8vIENyZWF0ZSBhIG5ldyBtb2R1bGUgKGFuZCBwdXQgaXQgaW50byB0aGUgY2FjaGUpXG4gXHRcdHZhciBtb2R1bGUgPSBpbnN0YWxsZWRNb2R1bGVzW21vZHVsZUlkXSA9IHtcbiBcdFx0XHRleHBvcnRzOiB7fSxcbiBcdFx0XHRpZDogbW9kdWxlSWQsXG4gXHRcdFx0bG9hZGVkOiBmYWxzZVxuIFx0XHR9O1xuXG4gXHRcdC8vIEV4ZWN1dGUgdGhlIG1vZHVsZSBmdW5jdGlvblxuIFx0XHRtb2R1bGVzW21vZHVsZUlkXS5jYWxsKG1vZHVsZS5leHBvcnRzLCBtb2R1bGUsIG1vZHVsZS5leHBvcnRzLCBfX3dlYnBhY2tfcmVxdWlyZV9fKTtcblxuIFx0XHQvLyBGbGFnIHRoZSBtb2R1bGUgYXMgbG9hZGVkXG4gXHRcdG1vZHVsZS5sb2FkZWQgPSB0cnVlO1xuXG4gXHRcdC8vIFJldHVybiB0aGUgZXhwb3J0cyBvZiB0aGUgbW9kdWxlXG4gXHRcdHJldHVybiBtb2R1bGUuZXhwb3J0cztcbiBcdH1cblxuXG4gXHQvLyBleHBvc2UgdGhlIG1vZHVsZXMgb2JqZWN0IChfX3dlYnBhY2tfbW9kdWxlc19fKVxuIFx0X193ZWJwYWNrX3JlcXVpcmVfXy5tID0gbW9kdWxlcztcblxuIFx0Ly8gZXhwb3NlIHRoZSBtb2R1bGUgY2FjaGVcbiBcdF9fd2VicGFja19yZXF1aXJlX18uYyA9IGluc3RhbGxlZE1vZHVsZXM7XG5cbiBcdC8vIF9fd2VicGFja19wdWJsaWNfcGF0aF9fXG4gXHRfX3dlYnBhY2tfcmVxdWlyZV9fLnAgPSBcIlwiO1xuXG4gXHQvLyBMb2FkIGVudHJ5IG1vZHVsZSBhbmQgcmV0dXJuIGV4cG9ydHNcbiBcdHJldHVybiBfX3dlYnBhY2tfcmVxdWlyZV9fKDApO1xuXG5cbi8qKiBXRUJQQUNLIEZPT1RFUiAqKlxuICoqIHdlYnBhY2svYm9vdHN0cmFwIDZhOThmMzE5OGQ2NGM4MTgzYTllXG4gKiovIiwiLyoqXG4gKiBDbGllbnQtc2lkZSBmb3JtIHZhbGlkYXRpb24gbG9naWMuIEZvcm0gZWxlbWVudCBpcyB2YWxpZGF0ZWQgYmFzZWRcbiAqIG9uIGBkYXRhLXZhbGlkYXRlYCBhdHRyaWJ1dGUsIGFuZCB2YWxpZGF0aW9uIG91dHB1dCBpcyBwbGFjZWQgaW5cbiAqIGNvcnJlc3BvbmRpbmcgYDxsYWJlbD5gLlxuICpcbiAqIFZhbGlkYXRpb25zIGNhbiBiZSBhZGRlZCBsYXRlciBieSBleHRlbmRpbmcgYE5FVUUuVmFsaWRhdGlvbi5WYWxpZGF0aW9uc2AuXG4gKiBWYWxpZGF0b3JzIGNhbiBiZSBhZGRlZCBsYXRlciBieSBleHRlbmRpbmcgYE5FVUUuVmFsaWRhdGlvbi5WYWxpZGF0b3JzYC5cbiAqXG4gKiBmaW5pc2hlZCB2YWxpZGF0aW5nIHdpdGggYSBib29sZWFuIGBzdWNjZXNzYCBhbmQgYSBwbGFpbi10ZXh0IGBtZXNzYWdlYFxuICogdmFsdWUuIChBbHRlcm5hdGl2ZWx5LCBhIGBzdWdnZXN0aW9uYCB2YWx1ZSBjYW4gYmUgcGFzc2VkIHdoaWNoIHdpbGxcbiAqIHByb21wdCB0aGUgdXNlciBcIkRpZCB5b3UgbWVhbiB7c3VnZ2VzdGlvbn0/XCIuXG4gKlxuICogIyMgVXNhZ2UgTm90ZXM6XG4gKiAtIElucHV0IGZpZWxkIG11c3QgaGF2ZSBgZGF0YS12YWxpZGF0ZWAgYXR0cmlidXRlLlxuICogLSBJZiBhZGRpbmcgaW5wdXQgZmllbGRzIHRvIHRoZSBET00gYWZ0ZXIgbG9hZCwgcnVuIGBwcmVwYXJlRmllbGRzYFxuICovXG5cbmltcG9ydCAkIGZyb20gXCJqcXVlcnlcIjtcbmltcG9ydCBFdmVudHMgZnJvbSBcIi4vZXZlbnRzXCI7XG52YXIgdmFsaWRhdGlvbnMgPSBbXTtcblxuXG4vKipcbiAqIFJldHVybnMgd2hldGhlciBlbGVtZW50IGlzIDxpbnB1dD4sIDxzZWxlY3Q+LCBvciA8dGV4dGFyZWE+LlxuICogQHBhcmFtIHtqUXVlcnl9ICRlbCAgRWxlbWVudCB0byBjaGVjayB0eXBlIG9mLlxuICogQHJldHVybiB7Ym9vbGVhbn1cbiAqL1xudmFyIGlzRm9ybUZpZWxkID0gZnVuY3Rpb24oJGVsKSB7XG4gIHZhciB0YWcgPSAkZWwucHJvcChcInRhZ05hbWVcIik7XG4gIHJldHVybiAoIHRhZyA9PT0gXCJJTlBVVFwiIHx8IHRhZyA9PT0gXCJTRUxFQ1RcIiB8fCB0YWcgPT09IFwiVEVYVEFSRUFcIiApO1xufTtcblxuXG4vKipcbiAqIFNob3cgdmFsaWRhdGlvbiBtZXNzYWdlIGluIG1hcmt1cC5cbiAqXG4gKiBAcGFyYW0ge2pRdWVyeX0gJGZpZWxkICAgICAgICAgICAgICBGaWVsZCB0byBkaXNwbGF5IHZhbGlkYXRpb24gbWVzc2FnZSBmb3IuXG4gKiBAcGFyYW0ge09iamVjdH0gcmVzdWx0ICAgICAgICAgICAgICBPYmplY3QgY29udGFpbmluZyBgc3VjY2Vzc2AgYW5kIGVpdGhlciBgbWVzc2FnZWAgb3IgYHN1Z2dlc3Rpb25gXG4gKi9cbnZhciBzaG93VmFsaWRhdGlvbk1lc3NhZ2UgPSBmdW5jdGlvbigkZmllbGQsIHJlc3VsdCkge1xuICB2YXIgJGZpZWxkTGFiZWwgPSAkKFwibGFiZWxbZm9yPSdcIiArICRmaWVsZC5hdHRyKFwiaWRcIikgKyBcIiddXCIpO1xuICB2YXIgJGZpZWxkVmFsaWRhdGlvbiA9ICRmaWVsZExhYmVsLmZpbmQoXCIudmFsaWRhdGlvblwiKTtcbiAgdmFyICRmaWVsZE1lc3NhZ2UgPSAkZmllbGRWYWxpZGF0aW9uLmZpbmQoXCIudmFsaWRhdGlvbl9fbWVzc2FnZVwiKTtcbiAgdmFyIGZpZWxkTGFiZWxIZWlnaHQgPSAkZmllbGRMYWJlbC5oZWlnaHQoKTtcbiAgdmFyIGZpZWxkTWVzc2FnZUhlaWdodDtcblxuICAkZmllbGQucmVtb3ZlQ2xhc3MoXCJoYXMtc3VjY2VzcyBoYXMtZXJyb3IgaGFzLXdhcm5pbmcgc2hha2VcIik7XG4gICRmaWVsZE1lc3NhZ2UucmVtb3ZlQ2xhc3MoXCJoYXMtc3VjY2VzcyBoYXMtZXJyb3IgaGFzLXdhcm5pbmdcIik7XG5cbiAgLy8gSGlnaGxpZ2h0L2FuaW1hdGUgZmllbGRcbiAgaWYocmVzdWx0LnN1Y2Nlc3MgPT09IHRydWUpIHtcbiAgICAkZmllbGQuYWRkQ2xhc3MoXCJoYXMtc3VjY2Vzc1wiKTtcbiAgICAkZmllbGRNZXNzYWdlLmFkZENsYXNzKFwiaGFzLXN1Y2Nlc3NcIik7XG4gIH0gZWxzZSB7XG4gICAgJGZpZWxkLmFkZENsYXNzKFwiaGFzLWVycm9yXCIpO1xuICAgICRmaWVsZE1lc3NhZ2UuYWRkQ2xhc3MoXCJoYXMtZXJyb3JcIik7XG5cbiAgICBpZiggaXNGb3JtRmllbGQoJGZpZWxkKSApIHtcbiAgICAgICRmaWVsZC5hZGRDbGFzcyhcInNoYWtlXCIpO1xuICAgIH1cblxuICAgIEV2ZW50cy5wdWJsaXNoKFwiVmFsaWRhdGlvbjpJbmxpbmVFcnJvclwiLCAkZmllbGRMYWJlbC5hdHRyKFwiZm9yXCIpKTtcbiAgfVxuXG4gIC8vIFNob3cgdmFsaWRhdGlvbiBtZXNzYWdlXG4gIGlmKHJlc3VsdC5tZXNzYWdlKSB7XG4gICAgJGZpZWxkTWVzc2FnZS50ZXh0KHJlc3VsdC5tZXNzYWdlKTtcbiAgfVxuXG4gIGlmKHJlc3VsdC5zdWdnZXN0aW9uKSB7XG4gICAgJGZpZWxkTWVzc2FnZS5odG1sKFwiRGlkIHlvdSBtZWFuIFwiICsgcmVzdWx0LnN1Z2dlc3Rpb24uZnVsbCArIFwiPyA8YSBocmVmPScjJyBkYXRhLXN1Z2dlc3Rpb249J1wiICsgcmVzdWx0LnN1Z2dlc3Rpb24uZnVsbCArIFwiJ2NsYXNzPSdqcy1tYWlsY2hlY2stZml4Jz5GaXggaXQhPC9hPlwiKTtcbiAgICBFdmVudHMucHVibGlzaChcIlZhbGlkYXRpb246U3VnZ2VzdGlvblwiLCByZXN1bHQuc3VnZ2VzdGlvbi5kb21haW4pO1xuICB9XG5cbiAgZmllbGRNZXNzYWdlSGVpZ2h0ID0gJGZpZWxkTWVzc2FnZS5oZWlnaHQoKTtcblxuICAvLyBTZXQgbGFiZWwgaGVpZ2h0IGlmIGl0IG5lZWRzIHRvIGJlIG11bHRpbGluZS5cbiAgaWYoZmllbGRNZXNzYWdlSGVpZ2h0ID4gZmllbGRMYWJlbEhlaWdodCkge1xuICAgICRmaWVsZExhYmVsLmNzcyhcImhlaWdodFwiLCBmaWVsZE1lc3NhZ2VIZWlnaHQgKyBcInB4XCIpO1xuICB9IGVsc2Uge1xuICAgIC8vIENsZWFyIHByZXZpb3VzIG11bHRpbGluZSBoZWlnaHQgaWYgbm8gbG9uZ2VyIG5lZWRlZC5cbiAgICAkZmllbGRMYWJlbC5jc3MoXCJoZWlnaHRcIiwgXCJcIik7XG4gIH1cblxuICAvLyBBbmltYXRlIGluIHRoZSB2YWxpZGF0aW9uIG1lc3NhZ2VcbiAgJGZpZWxkVmFsaWRhdGlvbi5hZGRDbGFzcyhcImlzLXNob3dpbmctbWVzc2FnZVwiKTtcblxuICAkKFwiLmpzLW1haWxjaGVjay1maXhcIikub24oXCJjbGlja1wiLCBmdW5jdGlvbihlKSB7XG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgdmFyICRmaWVsZCA9ICQoXCIjXCIgKyAkKHRoaXMpLmNsb3Nlc3QoXCJsYWJlbFwiKS5hdHRyKFwiZm9yXCIpKTtcbiAgICAkZmllbGQudmFsKCQodGhpcykuZGF0YShcInN1Z2dlc3Rpb25cIikpO1xuICAgICRmaWVsZC50cmlnZ2VyKFwiYmx1clwiKTtcblxuICAgIC8vIElmIEdvb2dsZSBBbmFseXRpY3MgaXMgc2V0IHVwLCB3ZSBmaXJlIGFuIGV2ZW50IHRvXG4gICAgLy8gbWFyayB0aGF0IGEgc3VnZ2VzdGlvbiBoYXMgYmVlbiBtYWRlXG4gICAgRXZlbnRzLnB1Ymxpc2goXCJWYWxpZGF0aW9uOlN1Z2dlc3Rpb25Vc2VkXCIsICQodGhpcykudGV4dCgpICk7XG4gIH0pO1xuXG4gICRmaWVsZC5vbihcImZvY3VzXCIsIGZ1bmN0aW9uKCkge1xuICAgICRmaWVsZC5yZW1vdmVDbGFzcyhcImhhcy13YXJuaW5nIGhhcy1lcnJvciBoYXMtc3VjY2VzcyBzaGFrZVwiKTtcbiAgICAkZmllbGRWYWxpZGF0aW9uLnJlbW92ZUNsYXNzKFwiaXMtc2hvd2luZy1tZXNzYWdlXCIpO1xuICAgICRmaWVsZExhYmVsLmNzcyhcImhlaWdodFwiLCBcIlwiKTtcbiAgfSk7XG5cbiAgcmV0dXJuIHJlc3VsdC5zdWNjZXNzO1xufTtcblxuXG4vKipcbiAqIFRyaWdnZXIgYSB2YWxpZGF0aW9uIG9uIGEgZm9ybSBlbGVtZW50LlxuICogQHBhcmFtIHtqUXVlcnl9ICAgJGZpZWxkICAgICAgICAgICAgICAgICAgICAgICAgICAgIEZvcm0gZWxlbWVudCB0byBiZSB2YWxpZGF0ZWQuXG4gKiBAcGFyYW0ge2pRdWVyeX0gICBbZm9yY2UgPSBmYWxzZV0gICAgICAgICAgICAgICAgICAgRm9yY2UgdmFsaWRhdGlvbiAoZXZlbiBvbiBlbXB0eSBmaWVsZHMpLlxuICogQHBhcmFtIHtmdW5jdGlvbn0gW2NhbGxiYWNrPXNob3dWYWxpZGF0aW9uTWVzc2FnZV0gIENhbGxiYWNrIGZ1bmN0aW9uIHRoYXQgcmVjZWl2ZXMgdmFsaWRhdGlvbiByZXN1bHRcbiAqL1xudmFyIHZhbGlkYXRlRmllbGQgPSBmdW5jdGlvbigkZmllbGQsIGZvcmNlLCBjYWxsYmFjaykge1xuICAvLyBEZWZhdWx0IGFyZ3VtZW50c1xuICBmb3JjZSA9IHR5cGVvZiBmb3JjZSAhPT0gXCJ1bmRlZmluZWRcIiA/IGZvcmNlIDogZmFsc2U7XG4gIGNhbGxiYWNrID0gdHlwZW9mIGNhbGxiYWNrICE9PSBcInVuZGVmaW5lZFwiID8gY2FsbGJhY2sgOiBmdW5jdGlvbigkZmllbGQsIHJlc3VsdCkge1xuICAgIHNob3dWYWxpZGF0aW9uTWVzc2FnZSgkZmllbGQsIHJlc3VsdCk7XG4gIH07XG5cbiAgdmFyIHZhbGlkYXRpb24gPSAkZmllbGQuZGF0YShcInZhbGlkYXRlXCIpO1xuXG4gIC8vIFRyaWdnZXIgYW55IG90aGVyIGxpbmtlZCB2YWxpZGF0aW9uXG4gIHZhciB2YWxpZGF0aW9uVHJpZ2dlciA9ICRmaWVsZC5kYXRhKFwidmFsaWRhdGUtdHJpZ2dlclwiKTtcbiAgaWYodmFsaWRhdGlvblRyaWdnZXIpIHtcbiAgICB2YWxpZGF0ZUZpZWxkKCAkKHZhbGlkYXRpb25UcmlnZ2VyKSApO1xuICB9XG5cblxuICAvLyBEb24ndCB2YWxpZGF0ZSBpZiB2YWxpZGF0aW9uIGRvZXNuJ3QgZXhpc3RcbiAgaWYoIXZhbGlkYXRpb25zW3ZhbGlkYXRpb25dKSB7XG4gICAgY29uc29sZS5lcnJvcihcIkEgdmFsaWRhdGlvbiB3aXRoIHRoZSBuYW1lIFwiKyB2YWxpZGF0aW9uICsgXCIgaGFzIG5vdCBiZWVuIHJlZ2lzdGVyZWQuXCIpO1xuICAgIHJldHVybjtcbiAgfVxuXG4gIC8vIEZvciA8aW5wdXQ+LCA8c2VsZWN0PiwgYW5kIDx0ZXh0YXJlYT4gdGFncyB3ZSBwcm92aWRlXG4gIC8vIHRoZSBmaWVsZCdzIHZhbHVlIGFzIGEgc3RyaW5nXG4gIGlmKCBpc0Zvcm1GaWVsZCgkZmllbGQpICkge1xuICAgIC8vIEdldCBmaWVsZCBpbmZvXG4gICAgdmFyIGZpZWxkVmFsdWUgPSAkZmllbGQudmFsKCk7XG5cbiAgICAvLyBGaW5hbGx5LCBsZXQncyBub3QgdmFsaWRhdGUgYmxhbmsgZmllbGRzIHVubGVzcyBmb3JjZWQgdG9cbiAgICBpZihmb3JjZSB8fCBmaWVsZFZhbHVlICE9PSBcIlwiKSB7XG4gICAgICBpZih2YWxpZGF0aW9uID09PSBcIm1hdGNoXCIpIHtcbiAgICAgICAgdmFyIG1hdGNoRmllbGRWYWx1ZSA9ICQoJGZpZWxkLmRhdGEoXCJ2YWxpZGF0ZS1tYXRjaFwiKSkudmFsKCk7XG4gICAgICAgIHZhbGlkYXRpb25zW3ZhbGlkYXRpb25dLmZuKGZpZWxkVmFsdWUsIG1hdGNoRmllbGRWYWx1ZSwgZnVuY3Rpb24ocmVzdWx0KSB7XG4gICAgICAgICAgY2FsbGJhY2soJGZpZWxkLCByZXN1bHQpO1xuICAgICAgICB9KTtcbiAgICAgIH0gZWxzZSB7XG4gICAgICAgIHZhbGlkYXRpb25zW3ZhbGlkYXRpb25dLmZuKGZpZWxkVmFsdWUsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICAgIGNhbGxiYWNrKCRmaWVsZCwgcmVzdWx0KTtcbiAgICAgICAgfSk7XG4gICAgICB9XG4gICAgfVxuICB9IGVsc2Uge1xuICAgIC8vIEZvciBhbGwgb3RoZXIgdGFncywgd2UgcGFzcyB0aGUgZWxlbWVudCBkaXJlY3RseVxuICAgIGlmKHZhbGlkYXRpb24gPT09IFwibWF0Y2hcIikge1xuICAgICAgdmFyICRtYXRjaEZpZWxkID0gJCgkZmllbGQuZGF0YShcInZhbGlkYXRlLW1hdGNoXCIpKTtcbiAgICAgIHZhbGlkYXRpb25zW3ZhbGlkYXRpb25dLmZuKCRmaWVsZCwgJG1hdGNoRmllbGQsIGZ1bmN0aW9uKHJlc3VsdCkge1xuICAgICAgICBjYWxsYmFjaygkZmllbGQsIHJlc3VsdCk7XG4gICAgICB9KTtcbiAgICB9IGVsc2Uge1xuICAgICAgdmFsaWRhdGlvbnNbdmFsaWRhdGlvbl0uZm4oJGZpZWxkLCBmdW5jdGlvbihyZXN1bHQpIHtcbiAgICAgICAgY2FsbGJhY2soJGZpZWxkLCByZXN1bHQpO1xuICAgICAgfSk7XG4gICAgfVxuICB9XG59O1xuXG5cbi8qKlxuICogUHJlcGFyZSBmaWVsZCBsYWJlbCBET00gdG8gZGlzcGxheSB2YWxpZGF0aW9uIG1lc3NhZ2VzLlxuICogQHBhcmFtIHtqUXVlcnl9ICRsYWJlbCBMYWJlbCBlbGVtZW50IHRvIHByZXBhcmUuXG4gKi9cbnZhciBwcmVwYXJlTGFiZWwgPSBmdW5jdGlvbigkbGFiZWwpIHtcbiAgLy8gQ2hlY2sgdG8gbWFrZSBzdXJlIHdlIGhhdmVuJ3QgYWxyZWFkeSBwcmVwYXJlZCB0aGlzIGJlZm9yZVxuICBpZigkbGFiZWwuZmluZChcIi52YWxpZGF0aW9uXCIpLmxlbmd0aCA9PT0gMCkge1xuICAgIHZhciAkaW5uZXJMYWJlbCA9ICQoXCI8ZGl2IGNsYXNzPSd2YWxpZGF0aW9uJz48L2Rpdj5cIik7XG4gICAgJGlubmVyTGFiZWwuYXBwZW5kKFwiPGRpdiBjbGFzcz0ndmFsaWRhdGlvbl9fbGFiZWwnPlwiICsgJGxhYmVsLmh0bWwoKSArIFwiPC9kaXY+XCIpO1xuICAgICRpbm5lckxhYmVsLmFwcGVuZChcIjxkaXYgY2xhc3M9J3ZhbGlkYXRpb25fX21lc3NhZ2UnPjwvZGl2PlwiKTtcblxuICAgICRsYWJlbC5odG1sKCRpbm5lckxhYmVsKTtcbiAgfVxufTtcblxuXG4vKipcbiAqIFByZXBhcmVzIGZvcm0gbGFiZWwgRE9NIHRvIGRpc3BsYXkgdmFsaWRhdGlvbiBtZXNzYWdlcyAmIHJlZ2lzdGVyIGV2ZW50IGhhbmRsZXJcbiAqIEBwYXJhbSB7alF1ZXJ5fSAkZmllbGRzIEZpZWxkcyB0byByZWdpc3RlciB2YWxpZGF0aW9uIGhhbmRsZXJzIHRvLlxuICovXG52YXIgcHJlcGFyZUZpZWxkcyA9IGZ1bmN0aW9uKCRmaWVsZHMpIHtcbiAgJGZpZWxkcy5lYWNoKGZ1bmN0aW9uKCkge1xuICAgIHZhciAkZmllbGQgPSAkKHRoaXMpO1xuXG4gICAgcHJlcGFyZUxhYmVsKCAkKFwibGFiZWxbZm9yPSdcIiArICRmaWVsZC5hdHRyKFwiaWRcIikgKyBcIiddXCIpICk7XG5cbiAgICAkZmllbGQub24oXCJibHVyXCIsIGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdmFsaWRhdGVGaWVsZCggJGZpZWxkICk7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuXG4vKipcbiAqIFJlZ2lzdGVyIGEgbmV3IHZhbGlkYXRpb24uXG4gKlxuICogQHBhcmFtIHtTdHJpbmd9ICAgIG5hbWUgICAgICAgICAgICAgIFRoZSBuYW1lIGZ1bmN0aW9uIHdpbGwgYmUgcmVmZXJlbmNlZCBieSBpbiBgZGF0YS12YWxpZGF0ZWAgYXR0cmlidXRlLlxuICogQHBhcmFtIHtPYmplY3R9ICAgIHZhbGlkYXRpb24gICAgICAgIENvbGxlY3Rpb24gb2YgdmFsaWRhdGlvbiBydWxlcyB0byBhcHBseVxuICogQHBhcmFtIHtGdW5jdGlvbn0gIFt2YWxpZGF0aW9uLmZuXSAgIEN1c3RvbSB2YWxpZGF0aW9uXG4gKi9cbnZhciByZWdpc3RlclZhbGlkYXRpb24gPSBmdW5jdGlvbihuYW1lLCB2YWxpZGF0aW9uKSB7XG4gIGlmKHZhbGlkYXRpb25zW25hbWVdKSB7XG4gICAgdGhyb3cgXCJBIHZhbGlkYXRpb24gZnVuY3Rpb24gd2l0aCB0aGF0IG5hbWUgaGFzIGFscmVhZHkgYmVlbiByZWdpc3RlcmVkXCI7XG4gIH1cblxuICB2YWxpZGF0aW9uc1tuYW1lXSA9IHZhbGlkYXRpb247XG59O1xuXG5cbi8qKlxuICogQERFUFJFQ0FURUQ6IFdpbGwgYmUgcmVtb3ZlZCBpbiBhIGZ1dHVyZSB2ZXJzaW9uIGluIGZhdm9yIG9mIGByZWdpc3RlclZhbGlkYXRpb25gLlxuICovXG52YXIgcmVnaXN0ZXJWYWxpZGF0aW9uRnVuY3Rpb24gPSBmdW5jdGlvbihuYW1lLCBmdW5jKSB7XG4gIHZhciB2ID0ge1xuICAgIGZuOiBmdW5jXG4gIH07XG5cbiAgcmVnaXN0ZXJWYWxpZGF0aW9uKG5hbWUsIHYpO1xufTtcblxuXG4vKipcbiAqIERpc2FibGUgZm9ybSBzdWJtaXNzaW9uLlxuICogQHBhcmFtIHtqUXVlcnl9ICRmb3JtIEZvcm0gdG8gZGlzYWJsZSBzdWJtaXNzaW9uIGZvci5cbiAqL1xudmFyIGRpc2FibGVGb3JtU3VibWl0ID0gZnVuY3Rpb24oJGZvcm0pIHtcbiAgLy8gUHJldmVudCBkb3VibGUtc3VibWlzc2lvbnNcbiAgdmFyICRzdWJtaXRCdXR0b24gPSAkZm9ybS5maW5kKFwiOnN1Ym1pdFwiKTtcblxuICAvLyBEaXNhYmxlIHRoYXQgZ3V5XG4gICRzdWJtaXRCdXR0b24uYXR0cihcImRpc2FibGVkXCIsIHRydWUpO1xuICAkc3VibWl0QnV0dG9uLmFkZENsYXNzKFwiaXMtbG9hZGluZ1wiKTtcbn07XG5cblxuLyoqXG4gKiBSZS1lbmFibGUgZm9ybSBzdWJtaXNzaW9uLlxuICogQHBhcmFtIHtqUXVlcnl9ICRmb3JtIEZvcm0gdG8gZW5hYmxlIHN1Ym1pc3Npb24gZm9yLlxuICovXG52YXIgZW5hYmxlRm9ybVN1Ym1pdCA9IGZ1bmN0aW9uKCRmb3JtKSB7XG4gIHZhciAkc3VibWl0QnV0dG9uID0gJGZvcm0uZmluZChcIjpzdWJtaXRcIik7XG4gICRzdWJtaXRCdXR0b24uYXR0cihcImRpc2FibGVkXCIsIGZhbHNlKTtcbiAgJHN1Ym1pdEJ1dHRvbi5yZW1vdmVDbGFzcyhcImlzLWxvYWRpbmcgaXMtZGlzYWJsZWRcIik7XG59O1xuXG5cbi8qKlxuICogVmFsaWRhdGUgZm9ybSBvbiBzdWJtaXQuXG4gKi9cbiQoXCJib2R5XCIpLm9uKFwic3VibWl0XCIsIFwiZm9ybVwiLCBmdW5jdGlvbihldmVudCwgaXNWYWxpZGF0ZWQpIHtcbiAgdmFyICRmb3JtID0gJCh0aGlzKTtcbiAgdmFyICR2YWxpZGF0aW9uRmllbGRzID0gJGZvcm0uZmluZChcIltkYXRhLXZhbGlkYXRlXVwiKTtcblxuICAvLyBEaXNhYmxlIGZvcm0gc3VibWlzc2lvbiB0byBwcmV2ZW50IGRvdWJsZS1jbGlja3MuXG4gIGRpc2FibGVGb3JtU3VibWl0KCRmb3JtKTtcblxuICAvLyBXZSB3YW50IHRvIHZhbGlkYXRlIGFsbCBbZGF0YS12YWxpZGF0ZV0gZmllbGQgdGhhdCBhcmUgZWl0aGVyIHJlcXVpcmVkLCBvciBoYXZlIHVzZXIgaW5wdXQuXG4gICR2YWxpZGF0aW9uRmllbGRzID0gJHZhbGlkYXRpb25GaWVsZHMubWFwKGZ1bmN0aW9uKCkge1xuICAgIHZhciAkdGhpcyA9ICQodGhpcyk7XG4gICAgaWYodHlwZW9mICR0aGlzLmF0dHIoXCJkYXRhLXZhbGlkYXRlLXJlcXVpcmVkXCIpICE9PSBcInVuZGVmaW5lZFwiIHx8ICR0aGlzLnZhbCgpICE9PSBcIlwiKSB7XG4gICAgICByZXR1cm4gJHRoaXM7XG4gICAgfVxuICB9KTtcblxuICAvLyBJZiBubyBmaWVsZHMgc2hvdWxkIGJlIHZhbGlkYXRlZCwgc3VibWl0IVxuICBpZigkdmFsaWRhdGlvbkZpZWxkcy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gdHJ1ZTtcbiAgfVxuXG4gIGlmKGlzVmFsaWRhdGVkID09PSB0cnVlKSB7XG4gICAgLy8gY29tcGxldGVkIGEgcHJldmlvdXMgcnVudGhyb3VnaCAmIHZhbGlkYXRlZDtcbiAgICAvLyB3ZSdyZSByZWFkeSB0byBzdWJtaXQgdGhlIGZvcm1cbiAgICByZXR1cm4gdHJ1ZTtcbiAgfSBlbHNlIHtcbiAgICBldmVudC5wcmV2ZW50RGVmYXVsdCgpO1xuXG4gICAgdmFyIHZhbGlkYXRlZEZpZWxkcyA9IDA7XG4gICAgdmFyIHZhbGlkYXRlZFJlc3VsdHMgPSAwO1xuICAgIHZhciBzY3JvbGxlZFRvRXJyb3IgPSBmYWxzZTtcblxuICAgICR2YWxpZGF0aW9uRmllbGRzLmVhY2goZnVuY3Rpb24oKSB7XG4gICAgICB2YWxpZGF0ZUZpZWxkKCQodGhpcyksIHRydWUsIGZ1bmN0aW9uKCRmaWVsZCwgcmVzdWx0KSB7XG4gICAgICAgIHZhbGlkYXRlZEZpZWxkcysrO1xuICAgICAgICBzaG93VmFsaWRhdGlvbk1lc3NhZ2UoJGZpZWxkLCByZXN1bHQpO1xuXG4gICAgICAgIGlmKHJlc3VsdC5zdWNjZXNzKSB7XG4gICAgICAgICAgdmFsaWRhdGVkUmVzdWx0cysrO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gSWYgdGhpcyBpcyB0aGUgZmlyc3QgZXJyb3IgaW4gdGhlIGZvcm0sIHNjcm9sbCB0byBpdC5cbiAgICAgICAgaWYoIXNjcm9sbGVkVG9FcnJvciAmJiByZXN1bHQuc3VjY2VzcyA9PT0gZmFsc2UpIHtcbiAgICAgICAgICBzY3JvbGxlZFRvRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICQoXCJodG1sLGJvZHlcIikuYW5pbWF0ZSh7c2Nyb2xsVG9wOiAkZmllbGQub2Zmc2V0KCkudG9wIC0gMzJ9LCAyMDApO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gT25jZSB3ZSdyZSBkb25lIHZhbGlkYXRpbmcgYWxsIGZpZWxkcywgY2hlY2sgc3RhdHVzIG9mIGZvcm1cbiAgICAgICAgaWYodmFsaWRhdGVkRmllbGRzID09PSAkdmFsaWRhdGlvbkZpZWxkcy5sZW5ndGgpIHtcbiAgICAgICAgICBpZih2YWxpZGF0ZWRSZXN1bHRzID09PSAkdmFsaWRhdGlvbkZpZWxkcy5sZW5ndGgpIHtcbiAgICAgICAgICAgIC8vIHdlJ3ZlIHZhbGlkYXRlZCBhbGwgdGhhdCBjYW4gYmUgdmFsaWRhdGVkXG4gICAgICAgICAgICBFdmVudHMucHVibGlzaChcIlZhbGlkYXRpb246U3VibWl0dGVkXCIsICQodGhpcykuYXR0cihcImlkXCIpICk7XG4gICAgICAgICAgICAkZm9ybS50cmlnZ2VyKFwic3VibWl0XCIsIHRydWUpO1xuICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICBFdmVudHMucHVibGlzaChcIlZhbGlkYXRpb246U3VibWl0RXJyb3JcIiwgJCh0aGlzKS5hdHRyKFwiaWRcIikgKTtcbiAgICAgICAgICAgIGVuYWJsZUZvcm1TdWJtaXQoJGZvcm0pO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gZmFsc2U7IC8vIGRvbid0IHN1Ym1pdCBmb3JtLCB3YWl0IGZvciBjYWxsYmFjayB3aXRoIGB0cnVlYCBwYXJhbWV0ZXJcbiAgfVxufSk7XG5cblxuLy8gUmVnaXN0ZXIgdGhlIFwibWF0Y2hcIiB2YWxpZGF0aW9uLlxucmVnaXN0ZXJWYWxpZGF0aW9uRnVuY3Rpb24oXCJtYXRjaFwiLCBmdW5jdGlvbihzdHJpbmcsIHNlY29uZFN0cmluZywgZG9uZSkge1xuICBpZihzdHJpbmcgPT09IHNlY29uZFN0cmluZyAmJiBzdHJpbmcgIT09IFwiXCIpIHtcbiAgICByZXR1cm4gZG9uZSh7XG4gICAgICBzdWNjZXNzOiB0cnVlLFxuICAgICAgbWVzc2FnZTogXCJMb29rcyBnb29kIVwiXG4gICAgfSk7XG4gIH0gZWxzZSB7XG4gICAgcmV0dXJuIGRvbmUoe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiBcIlRoYXQgZG9lc24ndCBtYXRjaC5cIlxuICAgIH0pO1xuICB9XG59KTtcblxuJChmdW5jdGlvbigpIHtcbiAgLy8gUHJlcGFyZSB0aGUgbGFiZWxzIG9uIGFueSBgW2RhdGEtdmFsaWRhdGVdYCBmaWVsZHMgaW4gdGhlIERPTSBhdCBsb2FkXG4gIHByZXBhcmVGaWVsZHMoICQoXCJib2R5XCIpLmZpbmQoXCJbZGF0YS12YWxpZGF0ZV1cIikgKTtcbn0pO1xuXG4vLyBFeHBvcnQgcHVibGljIEFQSTpcbmV4cG9ydCBkZWZhdWx0IHtcbiAgcHJlcGFyZUZpZWxkczogcHJlcGFyZUZpZWxkcyxcbiAgcmVnaXN0ZXJWYWxpZGF0aW9uOiByZWdpc3RlclZhbGlkYXRpb24sXG4gIHJlZ2lzdGVyVmFsaWRhdGlvbkZ1bmN0aW9uOiByZWdpc3RlclZhbGlkYXRpb25GdW5jdGlvbixcbiAgdmFsaWRhdGVGaWVsZDogdmFsaWRhdGVGaWVsZCxcbiAgc2hvd1ZhbGlkYXRpb25NZXNzYWdlOiBzaG93VmFsaWRhdGlvbk1lc3NhZ2UsXG4gIFZhbGlkYXRpb25zOiB2YWxpZGF0aW9ucyxcbiAgRXZlbnRzOiBFdmVudHNcbn07XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy92YWxpZGF0aW9uLmpzXG4gKiovIiwibW9kdWxlLmV4cG9ydHMgPSBfX1dFQlBBQ0tfRVhURVJOQUxfTU9EVUxFXzFfXztcblxuXG4vKioqKioqKioqKioqKioqKipcbiAqKiBXRUJQQUNLIEZPT1RFUlxuICoqIGV4dGVybmFsIHtcInJvb3RcIjpcImpRdWVyeVwiLFwiY29tbW9uanMyXCI6XCJqcXVlcnlcIixcImFtZFwiOlwianF1ZXJ5XCJ9XG4gKiogbW9kdWxlIGlkID0gMVxuICoqIG1vZHVsZSBjaHVua3MgPSAwXG4gKiovIiwiLyoqXG4gKiBQdWIvU3ViIGV2ZW50czogQWxsb3dzIG1vZHVsZXMgdG8gY29tbXVuaWNhdGUgdmlhIHB1Ymxpc2hpbmdcbiAqIGFuZCBzdWJzY3JpYmluZyB0byBldmVudHMuXG4gKlxuICogQmFzZWQgb24gQWRkeSBPc21hbmkncyBQdWJzdWJ6LCBsaWNlbnNlZCB1bmRlciB0aGUgR1BMLlxuICogaHR0cHM6Ly9naXRodWIuY29tL2FkZHlvc21hbmkvcHVic3VielxuICogaHR0cDovL2pzZmlkZGxlLm5ldC9MeFBycS9cbiAqL1xuXG52YXIgdG9waWNzID0ge307XG52YXIgc3ViVWlkID0gLTE7XG5cbnZhciBwdWJsaXNoID0gZnVuY3Rpb24odG9waWMsIGFyZ3MpIHtcbiAgaWYgKCF0b3BpY3NbdG9waWNdKSB7XG4gICAgcmV0dXJuIGZhbHNlO1xuICB9XG5cbiAgc2V0VGltZW91dChmdW5jdGlvbigpIHtcbiAgICB2YXIgc3Vic2NyaWJlcnMgPSB0b3BpY3NbdG9waWNdLFxuICAgICAgbGVuID0gc3Vic2NyaWJlcnMgPyBzdWJzY3JpYmVycy5sZW5ndGggOiAwO1xuXG4gICAgd2hpbGUobGVuLS0pIHtcbiAgICAgIHN1YnNjcmliZXJzW2xlbl0uZnVuYyh0b3BpYywgYXJncyk7XG4gICAgfVxuICB9LCAwKTtcblxuICByZXR1cm4gdHJ1ZTtcbn07XG5cbnZhciBzdWJzY3JpYmUgPSBmdW5jdGlvbih0b3BpYywgZnVuYykge1xuICBpZiAoIXRvcGljc1t0b3BpY10pIHtcbiAgICB0b3BpY3NbdG9waWNdID0gW107XG4gIH1cblxuICB2YXIgdG9rZW4gPSAoKytzdWJVaWQpLnRvU3RyaW5nKCk7XG4gIHRvcGljc1t0b3BpY10ucHVzaCh7XG4gICAgdG9rZW46IHRva2VuLFxuICAgIGZ1bmM6IGZ1bmNcbiAgfSk7XG5cbiAgcmV0dXJuIHRva2VuO1xufTtcblxudmFyIHVuc3Vic2NyaWJlID0gZnVuY3Rpb24odG9rZW4pIHtcbiAgZm9yICh2YXIgbSBpbiB0b3BpY3MpIHtcbiAgICBpZiAodG9waWNzW21dKSB7XG4gICAgICBmb3IgKHZhciBpID0gMCwgaiA9IHRvcGljc1ttXS5sZW5ndGg7IGkgPCBqOyBpKyspIHtcbiAgICAgICAgaWYgKHRvcGljc1ttXVtpXS50b2tlbiA9PT0gdG9rZW4pIHtcbiAgICAgICAgICB0b3BpY3NbbV0uc3BsaWNlKGksIDEpO1xuICAgICAgICAgIHJldHVybiB0b2tlbjtcbiAgICAgICAgfVxuICAgICAgfVxuICAgIH1cbiAgfVxuXG4gIHJldHVybiBmYWxzZTtcbn07XG5cbi8vIEV4cG9ydCBwdWJsaWMgQVBJXG5leHBvcnQgZGVmYXVsdCB7XG4gIHB1Ymxpc2g6IHB1Ymxpc2gsXG4gIHN1YnNjcmliZTogc3Vic2NyaWJlLFxuICB1bnN1YnNjcmliZTogdW5zdWJzY3JpYmVcbn07XG5cblxuXG4vKiogV0VCUEFDSyBGT09URVIgKipcbiAqKiAuL3NyYy9ldmVudHMuanNcbiAqKi8iXSwic291cmNlUm9vdCI6IiIsImZpbGUiOiJkaXN0L3ZhbGlkYXRpb24uanMifQ==